<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–ø–æ–¥–±–æ—Ä –Ω–∞—Å—Ç–æ–ª—å–Ω—ã—Ö –∏–≥—Ä</title>

  <style>
    * {
      box-sizing: border-box;
      text-transform: lowercase;
    }

    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      background: #fafafa;
    }

    h1 {
      margin-bottom: 20px;
    }

    select, input, button {
      width: 260px;
      padding: 8px;
      margin-bottom: 10px;
      display: block;
    }

    button {
      cursor: pointer;
    }

    .game {
      margin: 6px 0;
      padding: 6px;
      background: #ffffff;
      border: 1px solid #ddd;
    }

    .error {
      color: #888;
    }
  </style>
</head>

<body>

<h1>üé≤ –ø–æ–¥–±–æ—Ä –Ω–∞—Å—Ç–æ–ª—å–Ω—ã—Ö –∏–≥—Ä</h1>

<select id="genre">
  <option value="">–ª—é–±–æ–π –∂–∞–Ω—Ä</option>
  <option value="—Å–µ–º–µ–π–Ω–∞—è">—Å–µ–º–µ–π–Ω–∞—è</option>
  <option value="—Å—Ç—Ä–∞—Ç–µ–≥–∏—è">—Å—Ç—Ä–∞—Ç–µ–≥–∏—è</option>
  <option value="–≤–µ—á–µ—Ä–∏–Ω–æ—á–Ω–∞—è">–≤–µ—á–µ—Ä–∏–Ω–æ—á–Ω–∞—è</option>
  <option value="–∞–±—Å—Ç—Ä–∞–∫—Ç–Ω–∞—è">–∞–±—Å—Ç—Ä–∞–∫—Ç–Ω–∞—è</option>
  <option value="–Ω–∞—Å–ª–µ–¥–∏–µ">–Ω–∞—Å–ª–µ–¥–∏–µ</option>
</select>

<select id="difficulty">
  <option value="">–ª—é–±–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å</option>
  <option value="–ª—ë–≥–∫–∞—è">–ª—ë–≥–∫–∞—è</option>
  <option value="—Å—Ä–µ–¥–Ω—è—è">—Å—Ä–µ–¥–Ω—è—è</option>
  <option value="—Å–ª–æ–∂–Ω–∞—è">—Å–ª–æ–∂–Ω–∞—è</option>
</select>

<input id="players" type="number" placeholder="–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–≥—Ä–æ–∫–æ–≤">
<input id="time" type="number" placeholder="–º–∞–∫—Å. –≤—Ä–µ–º—è (–º–∏–Ω)">

<button onclick="filterGames()">–ø–æ–¥–æ–±—Ä–∞—Ç—å –∏–≥—Ä—É</button>

<div id="result"></div>

<script>
const sheetId = "1RynBSu-vpp79TLS35tOIfd_eZhYmAAbc387HGv_PJps";
const sheetName = "–ª–∏—Å—Ç1";

let games = [];

/* –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö */
fetch(`https://opensheet.elk.sh/${sheetId}/${sheetName}`)
  .then(r => r.json())
  .then(data => {
    games = data.map(row => ({
      name: (row["–Ω–∞–∑–≤–∞–Ω–∏–µ"] || "").toString().trim(),
      genre: (row["–∂–∞–Ω—Ä"] || "").toString().trim().toLowerCase(),
      difficulty: (row["—Å–ª–æ–∂–Ω–æ—Å—Ç—å"] || "").toString().trim().toLowerCase(),
      minPlayers: Number(row["–º–∏–Ω–∏–º—É–º –∏–≥—Ä–æ–∫–æ–≤"]),
      maxPlayers: Number(row["–º–∞–∫—Å–∏–º—É–º –∏–≥—Ä–æ–∫–æ–≤"]),
      time: Number(row["–≤—Ä–µ–º—è –∏–≥—Ä—ã"])
    }));
  })
  .catch(() => {
    document.getElementById("result").innerHTML =
      "<p class='error'>–æ—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö</p>";
  });

/* —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è */
function filterGames() {
  const genre = document.getElementById("genre").value.toLowerCase();
  const difficulty = document.getElementById("difficulty").value.toLowerCase();
  const players = Number(document.getElementById("players").value);
  const time = Number(document.getElementById("time").value);

  const filtered = games.filter(g =>
    (!genre || g.genre === genre) &&
    (!difficulty || g.difficulty === difficulty) &&
    (!players || (players >= g.minPlayers && players <= g.maxPlayers)) &&
    (!time || g.time <= time)
  );

  const result = document.getElementById("result");

  if (!filtered.length) {
    result.innerHTML = "<p class='error'>–ø–æ–¥—Ö–æ–¥—è—â–∏—Ö –∏–≥—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</p>";
    return;
  }

  result.innerHTML = filtered
    .map(g =>
      `<div class="game">
        üé≤ ${g.name}<br>
        –∂–∞–Ω—Ä: ${g.genre}<br>
        –∏–≥—Ä–æ–∫–∏: ${g.minPlayers}‚Äì${g.maxPlayers}<br>
        –≤—Ä–µ–º—è: ${g.time} –º–∏–Ω<br>
        —Å–ª–æ–∂–Ω–æ—Å—Ç—å: ${g.difficulty}
      </div>`
    )
    .join("");
}
</script>

</body>
</html>
